{
  "incident_summary": {
    "overview": "No dia 2024-06-01, o sistema de monitoramento gerou um alerta de 'Suspicious Login Attempt' referente a m\u00faltiplas tentativas de login malsucedidas para o usu\u00e1rio 'alice' no host 'server01', originadas do IP 192.168.1.100 via SSH (porta 22). O padr\u00e3o de tentativas e a origem incomum sugerem uma poss\u00edvel tentativa de acesso n\u00e3o autorizado.",
    "technical_classification": "De acordo com a UCO, o incidente envolve um 'UserAccount' (alice), um 'IPAddress' (192.168.1.100) e um 'EventLog' (registro de tentativas de login), caracterizando um ataque de for\u00e7a bruta ou enumera\u00e7\u00e3o de credenciais visando um 'DigitalAccount' via acesso remoto.",
    "severity_assessment": "Alta. Justifica-se pelo volume de tentativas, origem suspeita e risco de comprometimento de credenciais privilegiadas. O acesso n\u00e3o autorizado pode resultar em escalonamento de privil\u00e9gios e movimenta\u00e7\u00e3o lateral.",
    "potential_impact": "Comprometimento do usu\u00e1rio 'alice', acesso indevido a dados sens\u00edveis, poss\u00edvel instala\u00e7\u00e3o de backdoors, interrup\u00e7\u00e3o de servi\u00e7os e risco de propaga\u00e7\u00e3o para outros sistemas internos."
  },
  "investigation_steps": {
    "triage_steps": "1. Validar o alerta correlacionando logs de autentica\u00e7\u00e3o. 2. Identificar o escopo: outros usu\u00e1rios, hosts ou IPs envolvidos. 3. Verificar se houve sucesso em alguma tentativa de login. 4. Avaliar se h\u00e1 sinais de movimenta\u00e7\u00e3o lateral ou execu\u00e7\u00e3o de comandos p\u00f3s-login.",
    "evidence_collection": [
      {
        "description": "Coletar logs de autentica\u00e7\u00e3o do host afetado.",
        "command": "cp /var/log/auth.log /mnt/forensics/server01_authlog_20240601.log"
      },
      {
        "description": "Registrar conex\u00f5es de rede ativas para an\u00e1lise posterior.",
        "command": "netstat -antp > /mnt/forensics/server01_netstat_20240601.txt"
      },
      {
        "description": "Obter lista de processos em execu\u00e7\u00e3o.",
        "command": "ps aux > /mnt/forensics/server01_psaux_20240601.txt"
      },
      {
        "description": "Registrar o hist\u00f3rico de comandos do usu\u00e1rio 'alice'.",
        "command": "cp /home/alice/.bash_history /mnt/forensics/alice_bash_history_20240601.txt"
      }
    ],
    "technical_analysis": "Analisar os logs de autentica\u00e7\u00e3o para identificar padr\u00f5es de tentativas (hor\u00e1rios, frequ\u00eancia, origem). Verificar se houve login bem-sucedido ap\u00f3s as tentativas. Correlacionar o IP de origem com outras atividades suspeitas. Avaliar se outros usu\u00e1rios foram alvo. Buscar ind\u00edcios de brute force (excesso de tentativas em curto per\u00edodo) e poss\u00edveis credenciais comprometidas.",
    "tools_and_commands": [
      {
        "tool": "grep",
        "usage": "Filtrar tentativas de login do IP suspeito.",
        "example": "grep '192.168.1.100' /var/log/auth.log"
      },
      {
        "tool": "lastb",
        "usage": "Listar tentativas de login malsucedidas.",
        "example": "lastb | grep 'alice'"
      },
      {
        "tool": "logparser",
        "usage": "Analisar grandes volumes de logs para padr\u00f5es.",
        "example": "logparser 'SELECT * FROM /var/log/auth.log WHERE EventText LIKE \"%alice%\"'"
      },
      {
        "tool": "who",
        "usage": "Verificar sess\u00f5es ativas.",
        "example": "who"
      }
    ],
    "indicators_of_compromise": [
      "IP de origem: 192.168.1.100",
      "Usu\u00e1rio alvo: alice",
      "M\u00faltiplas falhas de login em curto per\u00edodo",
      "Tentativas via SSH (porta 22)",
      "Hor\u00e1rios incomuns de tentativa"
    ]
  },
  "containment_procedures": {
    "immediate_actions": "Bloquear imediatamente o IP de origem suspeito e monitorar tentativas subsequentes. Notificar o usu\u00e1rio 'alice' e a equipe de TI.",
    "system_isolation": "Se houver suspeita de comprometimento, isolar o 'server01' da rede para evitar movimenta\u00e7\u00e3o lateral. Exemplo: desconectar cabo de rede ou desabilitar interface.",
    "malicious_activity_blocking": "Adicionar regra de firewall para bloquear o IP 192.168.1.100: iptables -A INPUT -s 192.168.1.100 -j DROP. Se necess\u00e1rio, bloquear tentativas SSH de outros IPs suspeitos.",
    "evidence_preservation": "Antes de qualquer altera\u00e7\u00e3o, garantir a c\u00f3pia forense dos logs e artefatos de autentica\u00e7\u00e3o, processos e conex\u00f5es de rede. Utilizar comandos de c\u00f3pia para diret\u00f3rio seguro e montar m\u00eddia somente leitura para armazenamento."
  },
  "eradication_steps": {
    "threat_removal": "Revisar e redefinir a senha do usu\u00e1rio 'alice' e de outros usu\u00e1rios potencialmente afetados. Remover chaves SSH n\u00e3o autorizadas do ~/.ssh/authorized_keys. Revogar sess\u00f5es ativas suspeitas.",
    "vulnerability_fix": "Verificar e aplicar atualiza\u00e7\u00f5es de seguran\u00e7a no SSH e sistema operacional. Configurar bloqueio autom\u00e1tico ap\u00f3s X tentativas de login (ex: fail2ban). Desabilitar autentica\u00e7\u00e3o por senha, permitindo apenas chaves p\u00fablicas.",
    "lateral_movement_check": "Analisar logs de outros hosts para tentativas similares do IP 192.168.1.100. Buscar cria\u00e7\u00e3o de novos usu\u00e1rios ou altera\u00e7\u00f5es em privil\u00e9gios. Exemplo: grep 'useradd' /var/log/auth.log e revisar /etc/passwd por contas desconhecidas."
  },
  "recovery_procedures": {
    "system_restoration": "Ap\u00f3s erradica\u00e7\u00e3o, restaurar arquivos de configura\u00e7\u00e3o alterados a partir de backup \u00edntegro. Validar que n\u00e3o h\u00e1 persist\u00eancia de artefatos maliciosos.",
    "integrity_validation": "Executar verifica\u00e7\u00e3o de integridade dos principais bin\u00e1rios e arquivos de configura\u00e7\u00e3o: sha256sum -c /mnt/forensics/baseline_hashes.txt. Utilizar ferramentas como chkrootkit e rkhunter.",
    "return_to_operations": "Somente retornar o sistema \u00e0 opera\u00e7\u00e3o ap\u00f3s valida\u00e7\u00e3o de logs, confirma\u00e7\u00e3o de aus\u00eancia de acessos n\u00e3o autorizados e atualiza\u00e7\u00e3o de credenciais. Documentar todas as a\u00e7\u00f5es realizadas."
  },
  "lessons_learned_and_prevention": {
    "preventive_recommendations": "Implementar regras de detec\u00e7\u00e3o no SIEM para m\u00faltiplas falhas de login por IP/usu\u00e1rio. Configurar alertas para tentativas de login fora do hor\u00e1rio comercial ou de localidades incomuns.",
    "security_improvements": "Aplicar hardening no SSH (permitir apenas chaves, desabilitar root login, alterar porta padr\u00e3o). Implementar autentica\u00e7\u00e3o multifator para usu\u00e1rios privilegiados. Utilizar fail2ban ou similar.",
    "policy_updates": "Revisar e atualizar pol\u00edticas de senha e autentica\u00e7\u00e3o. Definir procedimentos claros para resposta a incidentes de acesso n\u00e3o autorizado. Treinar usu\u00e1rios sobre riscos de phishing e engenharia social."
  }
}